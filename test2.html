<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs" type="module"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js" type="text/javascript"></script>
    <script type="text/javascript">

        var viewportHeight = window.visualViewport.height;
        var viewportWidth = window.visualViewport.width;

        var theta = 60;
        var cannonOffsetY = viewportHeight - 30;
        var launchForce = 20000;
        var mass = 100;
        var v = 0; //initial velocity
        var gravity = 9.8; 
        var duration = 0;

        var yCoor = 0
        var xCoor = 0;

        var launchAngle = theta * (Math.PI/180);
        v = launchForce/mass;

        //yCoor = (xCoor * Math.tan(launchAngle)) - ((gravity * xCoor * xCoor)/((2 * v * v) * Math.cos(launchAngle) * Math.cos(launchAngle)));
        console.log("launch angle: " + launchAngle);
        console.log("Force: " + launchForce);
        console.log("Initial velocity: " + v);
        function moveElementAlongParabola(elementID) {
            let element = document.getElementById(elementID);
            const startX = element.getBoundingClientRect().left;
            const startY = element.getBoundingClientRect().top;
            let startTime = null;
            
            function animate(currentTime) {
                if (startTime === null) startTime = currentTime;

                const elapsedTime = (currentTime - startTime)/200;


                const yCoor = (v * Math.sin(launchAngle) * elapsedTime) - (.5 * gravity * elapsedTime * elapsedTime);
                const xCoor = v * Math.cos(launchAngle) * elapsedTime;
                console.log("(" + xCoor + "," + yCoor + ")");

                element.style.left = (startX + xCoor) + "px";
                element.style.top = (startY - yCoor) + "px";

                $("#player").css("transform","rotate(31deg)");

                if(xCoor > 400 ){
                window.scrollTo((xCoor - 300)/2,0);
                }
                //console.log("left ^: " + xCoor + "px")
                //console.log("top ^: " + yCoor + "px")

                if ( yCoor >= 0) {
                    requestAnimationFrame(animate);
                }
                else{
                    $("#player").animate({transform: 360}, {
                        step: function(now,fx) {
                            $(this).css({
                                '-webkit-transform':'rotate('+now+'deg)', 
                                '-moz-transform':'rotate('+now+'deg)',
                                'transform':'rotate('+now+'deg)'
                            });
                        }
                    });
                }


            }

            requestAnimationFrame(animate);
        }

        // Example usage:
        $(document).ready(function(){
            $("body").css({"width": (viewportWidth * 5) + "px", "height": (viewportHeight * 3) + "px"});
            $("#candyBackground").css({"height": viewportHeight + "px", top: (-1 * .2 * viewportHeight) + "px", "width": (viewportWidth * 5) + "px"});
            $(".path").css({"height": (viewportHeight * .35) + "px", "width": (viewportWidth * 5) + "px"});
            scrollTo(0,viewportHeight * 3);
            moveElementAlongParabola("characterContainer"); // 2 seconds duration
        });





    </script>
    <link rel="stylesheet" type="text/css" href="styles.css" />
<title>Page Title</title>
</head>
<body>    
    <div id="candyBackground"></div>
    <div class="path">
        <img class="pathImg" src="stonepath.png" />
        <img class="pathImg" src="stonepath.png" />
        <img class="pathImg" src="stonepath.png" />
        <img class="pathImg" src="stonepath.png" />
        <img class="pathImg" src="stonepath.png" />
        <img class="pathImg" src="stonepath.png" />
        <img class="pathImg" src="stonepath.png" />
        <img class="pathImg" src="stonepath.png" />
        <img class="pathImg" src="stonepath.png" />
        <img class="pathImg" src="stonepath.png" />
    </div>
    <div id="characterContainer">
        <img id="player" class="character" src="boy.png" />
    </div>
</body>
</html>
